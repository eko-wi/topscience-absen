<!DOCTYPE html>
<html>
  <head>
    <title>TOPScience - absen</title>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <h1>TOPScience absen</h1><br>
    <p>Dapatkan token kehadiran ekskul dengan mengunjungi:</p><br>
    <button id=getotp type="button" onclick="getotp()">TOPSCIENCE OTP generator</button>
    <p id=otp>...</p><br>
    <p id=hasil>...</p>

    <script>
      const gaslink="https://script.google.com/macros/s/AKfycbxCk4RMYfEdMGHp7H65H8zFglMbjSVh_K85MhWRkZKUAAjtlzGLsurvVKCByIAwp6ul5w/exec"
      const devid = "esp-topscience-absen";
      async function getotp(){
        const otx = document.getElementById("otp");
        otx.innerText="Menunggu... Anda akan langsung redirect ke form absensi.";
        document.getElementById("getotp").disabled=true;
        const res = await fetch(gaslink+"?id="+devid);
        const d = await res.text();
        const ip = atob(d);
        otx.innerText = ip;        
        console.log(ip+"/t");
        document.getElementById('hasil').innerText="redirecting...";
        location.href="http:"+ip+"/t";
      }
    </script>
  </body>
</html>
